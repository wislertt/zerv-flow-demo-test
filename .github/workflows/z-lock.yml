name: lock-dispatch

on:
    push:

permissions:
    contents: write

jobs:
    lock:
        runs-on: ubuntu-latest
        steps:
            - uses: suzuki-shunsuke/lock-action@latest
              id: lock
              with:
                  mode: "lock"
                  key: "d"

            - uses: suzuki-shunsuke/lock-action@latest
              id: check-lock
              with:
                  mode: "check"
                  key: "d"

            - name: Check lock status
              run: |
                  echo "=== Lock Information ==="
                  echo "steps.lock.locked: ${{ steps.lock.locked }}"
                  echo "steps.lock.outputs.already_locked: ${{ steps.lock.outputs.already_locked }}"

                  echo "=== CheckLock Information ==="
                  echo "steps.check-lock.locked: ${{ steps.check-lock.locked }}"
                  echo "steps.check-lock.outputs.already_locked: ${{ steps.check-lock.outputs.already_locked }}"
